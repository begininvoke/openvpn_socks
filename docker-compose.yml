version: "3"

# Try `docker-compose up`

services:
    ovpn_proxy:
        build: .
        image: openvpn-socks:local
        cap_add:
            - NET_ADMIN
        devices:
            - /dev/net/tun
        volumes:
            - ./config.ovpn:/config/config.ovpn
            # Optional: use a credentials file (line 1 = username, line 2 = password) instead of env vars
            - ./openvpn-credentials.txt:/config/openvpn-credentials.txt:ro
        environment:
            # Use credentials file at /config/openvpn-credentials.txt if mounted; else use .env:
            - OPENVPN_CREDENTIALS_FILE=/config/openvpn-credentials.txt
            - OPENVPN_USERNAME=${OPENVPN_USERNAME}
            - OPENVPN_PASSWORD=${OPENVPN_PASSWORD}
        ports:
            - 1080:1080
        restart: always
